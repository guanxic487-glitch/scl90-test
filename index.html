<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>SCL-90 å¿ƒç†å¥åº·æ·±åº¦è¯„ä¼°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* === 1. ç°ä»£åŒ»ç–—é…è‰²ç³»ç»Ÿ === */
        :root {
            /* å“ç‰Œè‰²ï¼šæ›´æ²‰ç¨³çš„åŒ»ç–—è“ */
            --primary: #4338ca;       
            --primary-soft: #e0e7ff; 
            
            /* çŠ¶æ€è‰²ï¼šé²œæ˜ä½†ä¸åˆºçœ¼ */
            --success: #059669; /* ç¿¡ç¿ ç»¿ */
            --warning: #d97706; /* ç¥ç€é»„ */
            --orange: #ea580c;  /* æ·±æ©™ */
            --danger: #dc2626;  /* è­¦ç¤ºçº¢ */
            
            /* ä¸­æ€§è‰² */
            --text-main: #111827;
            --text-sub: #6b7280;
            --bg-body: #f3f4f6;
            
            /* è´¨æ„Ÿï¼šå¼¥æ•£æŠ•å½± */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-card: 0 10px 30px -5px rgba(0, 0, 0, 0.06);
            --shadow-float: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        html { font-size: 16px; }
        @media (max-width: 600px) { html { font-size: 14px; } }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            /* é¡¶éƒ¨å¢åŠ ä¸€ä¸ªè£…é¥°æ€§çš„æ¸å˜èƒŒæ™¯å— */
            background-image: linear-gradient(to bottom, #e0e7ff 0%, #f3f4f6 400px);
            background-repeat: no-repeat;
            color: var(--text-main);
            margin: 0;
            padding: 20px 15px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            width: 100%;
            max-width: 750px; /* ç¨å¾®æ”¶çª„ä¸€ç‚¹ï¼Œé˜…è¯»ä½“éªŒæ›´å¥½ */
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px); /* æ¯›ç»ç’ƒ */
            border-radius: 24px; /* æ›´å¤§çš„åœ†è§’ */
            box-shadow: var(--shadow-card);
            overflow: hidden;
            margin-top: 1vh;
            padding-bottom: 3rem;
            position: relative;
            border: 1px solid rgba(255,255,255,0.6);
        }

        /* === æ‚¬æµ®å·¥å…· === */
        #magic-fill-btn {
            position: fixed; bottom: 30px; right: 30px; 
            width: 56px; height: 56px;
            background: linear-gradient(135deg, #4f46e5, #4338ca);
            color: white; border-radius: 50%;
            display: flex; justify-content: center; align-items: center; font-size: 24px;
            box-shadow: var(--shadow-float); cursor: pointer; z-index: 10000;
            border: 2px solid rgba(255,255,255,0.3);
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        #magic-fill-btn:hover { transform: scale(1.1) rotate(15deg); }
        .hidden-btn { display: none !important; }

        /* === ç™»å½•å±‚ === */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(243, 244, 246, 0.95); z-index: 9999;
            backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center; padding: 20px;
        }
        .login-card {
            background: white; padding: 3rem 2rem; border-radius: 20px;
            box-shadow: var(--shadow-float); width: 100%; max-width: 380px; text-align: center;
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        .login-input {
            width: 100%; padding: 14px; margin: 25px 0 10px 0; 
            border: 2px solid #e5e7eb; border-radius: 12px; 
            font-size: 1.1rem; outline: none; text-align: center; letter-spacing: 2px;
            transition: all 0.3s;
            background: #f9fafb;
        }
        .login-input:focus { border-color: var(--primary); background: #fff; box-shadow: 0 0 0 4px var(--primary-soft); }

        /* === é¡¶éƒ¨å¸é™„è¿›åº¦æ¡ === */
        .progress-box {
            position: sticky; top: 0; 
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);
            z-index: 50; padding: 1rem 2rem; 
            border-bottom: 1px solid rgba(0,0,0,0.03);
            display: flex; flex-direction: column; gap: 10px;
            transition: all 0.3s;
        }
        .progress-info { display: flex; justify-content: space-between; font-size: 0.85rem; font-weight: 700; letter-spacing: 0.5px; }
        .progress-track { width: 100%; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #6366f1, #4338ca); width: 0%; transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 4px; }

        /* === å†…å®¹åŒºé€šç”¨ === */
        .content-area { padding: 2.5rem 2rem; animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h1 { font-size: 2rem; margin: 0 0 1rem 0; color: var(--primary); text-align: center; letter-spacing: -0.5px; font-weight: 800; }
        
        /* æŒ‰é’®å‡çº§ */
        .btn {
            display: block; width: 100%; padding: 1.1rem; 
            background: var(--primary); color: white; border: none;
            border-radius: 14px; font-size: 1.05rem; font-weight: 600; 
            cursor: pointer; margin-top: 20px;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.2);
            transition: all 0.2s;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.3); }
        .btn:active { transform: scale(0.98); }

        /* === é¢˜ç›®å¡ç‰‡ === */
        .question-card { 
            background: #fff; padding: 2rem; border-radius: 16px; margin-bottom: 1.5rem; 
            box-shadow: var(--shadow-sm); border: 1px solid rgba(0,0,0,0.02);
            transition: transform 0.3s;
        }
        .question-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-card); }
        .q-text { font-size: 1.25rem; font-weight: 700; margin-bottom: 1.5rem; color: #111827; line-height: 1.4; }
        
        .options-group { display: flex; flex-wrap: wrap; gap: 10px; }
        .option-item { flex: 1; min-width: 70px; cursor: pointer; position: relative; }
        .option-item input { position: absolute; opacity: 0; }
        .option-box {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 1rem 0.5rem; background: #f9fafb; 
            border: 2px solid transparent; border-radius: 12px; 
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .option-val { font-size: 1.4rem; font-weight: 700; margin-bottom: 4px; color: #9ca3af; transition: color 0.2s; }
        .option-label { font-size: 0.8rem; color: #9ca3af; font-weight: 500; transition: color 0.2s; }
        
        /* é€‰ä¸­æ€ */
        .option-item input:checked + .option-box { 
            background: var(--primary-soft); 
            border-color: var(--primary); 
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
        }
        .option-item input:checked + .option-box .option-val { color: var(--primary); }
        .option-item input:checked + .option-box .option-label { color: var(--primary); }

        /* === ç»“æœé¡µæ ¸å¿ƒï¼šè¯¦ç»†æ•°æ®å¡ç‰‡ === */
        .detail-card {
            background: #fff; border-radius: 16px;
            padding: 2rem; margin-bottom: 2rem; 
            box-shadow: var(--shadow-card);
            border: 1px solid rgba(0,0,0,0.03);
            position: relative;
        }
        
        /* æ ‡é¢˜å¤´ */
        .dc-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .dc-title { font-size: 1.2rem; font-weight: 800; color: #1f2937; }
        .dc-tag { 
            font-size: 0.85rem; padding: 4px 12px; border-radius: 20px; 
            font-weight: 700; letter-spacing: 0.5px;
        }
        
        /* å¤§åˆ†æ•°å€¼ */
        .dc-score-box { text-align: right; margin-bottom: 15px; }
        .dc-score-val { font-size: 2.5rem; font-weight: 800; color: #111827; line-height: 1; letter-spacing: -1px; }
        
        /* åˆ»åº¦æ¡å®¹å™¨ */
        .scale-container { margin: 2rem 0 1.5rem 0; }
        
        /* è¿›åº¦æ¡èƒŒæ™¯æ§½ */
        .scale-track {
            height: 12px; background: #f3f4f6; border-radius: 6px; position: relative; overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        /* è¿›åº¦æ¡å¡«å…… */
        .scale-fill { height: 100%; border-radius: 6px; width: 0%; transition: width 1.2s cubic-bezier(0.34, 1.56, 0.64, 1); box-shadow: 2px 0 5px rgba(0,0,0,0.1); }
        
        /* åˆ»åº¦æ ‡ç­¾ */
        .scale-labels {
            display: flex; justify-content: space-between; margin-top: 10px;
            font-size: 0.75rem; color: #9ca3af; position: relative; height: 40px; font-weight: 500;
        }
        .scale-mark { position: absolute; transform: translateX(-50%); text-align: center; }
        .scale-mark span { display: block; margin-bottom: 4px; color: #6b7280; font-weight: 700; }

        /* ç¯å½¢å›¾å®¹å™¨ */
        .donut-box { width: 140px; height: 140px; margin: 0 auto 1.5rem auto; position: relative; }
        .donut-center {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 1.5rem; font-weight: 800; color: #1f2937;
        }

        /* è§£è¯»æ–‡æœ¬ */
        .dc-text {
            font-size: 0.95rem; color: #4b5563; line-height: 1.7;
            background: #f9fafb; padding: 1.2rem; border-radius: 12px; margin-top: 20px;
            border-left: 5px solid #d1d5db;
        }

        /* å› å­ç½‘æ ¼ */
        .result-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
        .factor-card { background: #fff; border-radius: 16px; padding: 1.5rem; border: 1px solid #f3f4f6; box-shadow: var(--shadow-sm); transition: transform 0.2s; }
        .factor-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-card); }
        .f-progress-bg { height: 8px; background: #f3f4f6; border-radius: 4px; overflow: hidden; margin-bottom: 12px; }
        .f-progress-bar { height: 100%; border-radius: 4px; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="magic-fill-btn" class="hidden-btn" onclick="autoFill()" title="ä¸€é”®å¡«æ»¡ (Debug)">âš¡ï¸</div>

    <div id="login-overlay">
        <div class="login-card">
            <div style="font-size: 3.5rem; margin-bottom: 1rem;">ğŸ”</div>
            <h2 style="margin: 0; font-size: 1.5rem; color: var(--text-main);">è®¿å®¢éªŒè¯</h2>
            <p style="color: var(--text-sub); margin-top: 5px; font-size: 0.9rem;">æœ¬æµ‹è¯„ä¸ºä¸“ä¸šç‰ˆï¼Œè¯·è¾“å…¥é€šè¡Œç </p>
            <input type="text" id="code-input" class="login-input" placeholder="è¾“å…¥å…‘æ¢ç " maxlength="20">
            <div id="login-msg" style="color: var(--danger); font-size: 0.85rem; height: 20px; font-weight: 600;"></div>
            <button class="btn" onclick="verifyCode()">ç«‹å³è¿›å…¥</button>
        </div>
    </div>

<div class="container">
    
    <div id="welcome-screen" class="content-area hidden" style="text-align: center; padding-top: 4rem;">
        <div style="font-size: 5rem; margin-bottom: 1.5rem; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.1));">ğŸ§ </div>
        <h1>SCL-90 å¿ƒç†å¥åº·ç”»åƒ</h1>
        <p style="font-size: 1.1rem; color: var(--text-sub); margin-bottom: 3rem;">90é¡¹ä¸´åºŠçº§æ·±åº¦è¯„ä¼° Â· æ™ºèƒ½æ•°æ®è§£è¯»</p>
        
        <div style="text-align: left; background: #fff; padding: 2rem; border-radius: 16px; margin: 2rem 0; border: 1px solid rgba(0,0,0,0.04); box-shadow: var(--shadow-sm);">
            <h3 style="margin:0 0 1rem 0; color: var(--primary); font-size: 1.1rem;">ğŸ“‹ æµ‹å‰æŒ‡å—</h3>
            <ul style="padding-left: 20px; color: var(--text-main); line-height: 1.8;">
                <li>è¯·å›æƒ³æ‚¨<strong>æœ€è¿‘ä¸€å‘¨</strong>ï¼ˆåŒ…æ‹¬ä»Šå¤©ï¼‰çš„å®é™…æ„Ÿå—ã€‚</li>
                <li>è¯„åˆ†èŒƒå›´ï¼š<strong>1åˆ†(ä»æ— )</strong> â†’ <strong>5åˆ†(ä¸¥é‡)</strong>ã€‚</li>
                <li>æœ¬æµ‹è¯•ç»“æœä»…ä¾›è‡ªæˆ‘å‚è€ƒï¼Œä¸¥ç¦ç”¨äºä¸´åºŠè¯Šæ–­ã€‚</li>
            </ul>
        </div>
        <button class="btn" style="width: 80%; margin: 2rem auto 0 auto;" onclick="startTest()">å¼€å§‹ä¸“ä¸šæµ‹è¯„</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div class="progress-box">
            <div class="progress-info">
                <span style="color:var(--primary)">å·²å®Œæˆï¼š<b id="answered-count">0</b></span>
                <span style="color:var(--text-sub)">å‰©ä½™ï¼š<b id="remaining-count">90</b></span>
            </div>
            <div class="progress-track"><div class="progress-fill" id="progress-fill"></div></div>
        </div>
        <div class="content-area" id="questions-container"></div>
        <div style="padding: 0 2rem 3rem 2rem;">
            <button class="btn" onclick="calculateResult()">ç”Ÿæˆåˆ†ææŠ¥å‘Š</button>
        </div>
    </div>

    <div id="result-screen" class="content-area hidden">
        <h1 style="margin-bottom: 0.5rem;">æ‚¨çš„å¿ƒç†å¥åº·ç”»åƒ</h1>
        <p style="text-align: center; color: var(--text-sub); margin-bottom: 2.5rem; font-size: 0.9rem;">
            ç”Ÿæˆæ—¶é—´ï¼š<span id="report-date" style="font-weight: 600;"></span>
        </p>

        <div style="position: relative; width: 100%; height: 0; padding-bottom: 100%; margin: 0 auto 3rem auto;">
            <canvas id="radarChart"></canvas>
        </div>

        <div style="display: flex; align-items: center; margin-bottom: 1.5rem;">
            <div style="width: 6px; height: 24px; background: var(--primary); border-radius: 3px; margin-right: 10px;"></div>
            <h2 style="margin: 0; font-size: 1.4rem; color: #1f2937;">æ ¸å¿ƒæŒ‡æ ‡åˆ†æ</h2>
        </div>
        
        <div class="detail-card">
            <div class="dc-header">
                <span class="dc-title">æ€»åˆ† (Total Score)</span>
                <span id="ts-tag" class="dc-tag" style="background: #f3f4f6; color: #666;">è®¡ç®—ä¸­...</span>
            </div>
            <div class="dc-score-box">
                <span id="ts-val" class="dc-score-val">0</span>
                <span style="font-size:1rem; color:#9ca3af; font-weight: 600;">/ 450</span>
            </div>
            <div class="scale-container">
                <div class="scale-track">
                    <div id="ts-bar" class="scale-fill"></div>
                </div>
                <div class="scale-labels">
                    <div class="scale-mark" style="left:0%"><span>0</span></div>
                    <div class="scale-mark" style="left:35.5%"><span>160</span>æ­£å¸¸</div>
                    <div class="scale-mark" style="left:50%"><span>225</span>è½»åº¦</div>
                    <div class="scale-mark" style="left:70%"><span>315</span>ä¸­åº¦</div>
                    <div class="scale-mark" style="left:100%"><span>450</span>é‡åº¦</div>
                </div>
            </div>
            <div id="ts-text" class="dc-text"></div>
        </div>

        <div class="detail-card" style="text-align: center;">
            <div class="dc-header">
                <span class="dc-title">é˜³æ€§é¡¹ç›®æ•°</span>
                <span id="pi-tag" class="dc-tag">è®¡ç®—ä¸­</span>
            </div>
            <div class="donut-box">
                <canvas id="piChart"></canvas>
                <div class="donut-center"><span id="pi-val">0</span><span style="font-size:0.9rem; color:#9ca3af; font-weight:600">/90</span></div>
            </div>
            <div style="display:flex; justify-content: center; gap: 20px; font-size:0.85rem; color:#6b7280; margin-top:15px;">
                <span style="display:flex; align-items:center;"><span style="width:8px; height:8px; background:#10b981; border-radius:50%; margin-right:6px;"></span>æ­£å¸¸ (â‰¤43)</span>
                <span style="display:flex; align-items:center;"><span style="width:8px; height:8px; background:#ef4444; border-radius:50%; margin-right:6px;"></span>é˜³æ€§ (>43)</span>
            </div>
            <div id="pi-text" class="dc-text" style="text-align: left;"></div>
        </div>

        <div class="detail-card">
            <div class="dc-header">
                <span class="dc-title">é˜³æ€§ç—‡çŠ¶å‡åˆ†</span>
                <span id="pm-tag" class="dc-tag">è®¡ç®—ä¸­...</span>
            </div>
            <div class="dc-score-box">
                <span id="pm-val" class="dc-score-val">0.0</span>
                <span style="font-size:1rem; color:#9ca3af; font-weight: 600;">/ 5.0</span>
            </div>
            <div class="scale-container">
                <div class="scale-track">
                    <div id="pm-bar" class="scale-fill"></div>
                </div>
                <div class="scale-labels">
                    <div class="scale-mark" style="left:0%"><span>0</span></div>
                    <div class="scale-mark" style="left:30%"><span>1.5</span>æ­£å¸¸</div>
                    <div class="scale-mark" style="left:50%"><span>2.5</span>è½»åº¦</div>
                    <div class="scale-mark" style="left:70%"><span>3.5</span>ä¸­åº¦</div>
                    <div class="scale-mark" style="left:100%"><span>5.0</span>é‡åº¦</div>
                </div>
            </div>
            <div id="pm-text" class="dc-text"></div>
        </div>

        <div style="display: flex; align-items: center; margin: 3rem 0 1.5rem 0;">
            <div style="width: 6px; height: 24px; background: var(--primary); border-radius: 3px; margin-right: 10px;"></div>
            <h2 style="margin: 0; font-size: 1.4rem; color: #1f2937;">å› å­æ·±åº¦è§£è¯»</h2>
        </div>
        <div id="result-grid" class="result-grid"></div>
        
        <div style="margin-top: 3rem; text-align: center;">
            <button class="btn" style="background: #9ca3af; width: auto; display: inline-block; padding: 0.8rem 2rem;" onclick="location.reload()">â†º é‡æ–°æµ‹è¯•</button>
        </div>
    </div>

</div>

<script>
    // === 1. åŸºç¡€é…ç½® ===
    const validCodes = ["VIP888", "SCL2024", "TEST001"]; 
    const factors = {
        "èº¯ä½“åŒ–": [1, 4, 12, 27, 40, 42, 48, 49, 52, 53, 56, 58],
        "å¼ºè¿«ç—‡çŠ¶": [3, 9, 10, 28, 38, 45, 46, 51, 55, 65],
        "äººé™…å…³ç³»æ•æ„Ÿ": [6, 21, 34, 36, 37, 41, 61, 69, 73],
        "æŠ‘éƒ": [5, 14, 15, 20, 22, 26, 29, 30, 31, 32, 54, 71, 79],
        "ç„¦è™‘": [2, 17, 23, 33, 39, 57, 72, 78, 80, 86],
        "æ•Œå¯¹": [11, 24, 63, 67, 74, 81],
        "ææ€–": [13, 25, 47, 50, 70, 75, 82],
        "åæ‰§": [8, 18, 43, 68, 76, 83],
        "ç²¾ç¥ç—…æ€§": [7, 16, 35, 62, 77, 84, 85, 87, 88, 90],
        "å…¶ä»–": [19, 44, 59, 60, 64, 66, 89] 
    };
    const questionTextList = [
        "å¤´ç—›", "ç¥ç»è¿‡æ•ï¼Œå¿ƒä¸­ä¸è¸å®", "å¤´è„‘ä¸­æœ‰ä¸å¿…è¦çš„æƒ³æ³•æˆ–å­—å¥ç›˜æ—‹", "å¤´æ™•æˆ–æ˜å€’", "å¯¹å¼‚æ€§çš„å…´è¶£å‡é€€", 
        "å¯¹æ—äººè´£å¤‡æ±‚å…¨", "æ„Ÿåˆ°åˆ«äººèƒ½æ§åˆ¶æ‚¨çš„æ€æƒ³", "è´£æ€ªåˆ«äººåˆ¶é€ éº»çƒ¦", "å¿˜æ€§å¤§", "æ‹…å¿ƒè‡ªå·±çš„è¡£é¥°æ•´é½åŠä»ªæ€çš„ç«¯åº„", 
        "å®¹æ˜“çƒ¦æ¼å’Œæ¿€åŠ¨", "èƒ¸ç—›", "å®³æ€•ç©ºæ—·çš„åœºæ‰€æˆ–è¡—é“", "æ„Ÿåˆ°è‡ªå·±çš„ç²¾åŠ›ä¸‹é™ï¼Œæ´»åŠ¨å‡æ…¢", "æƒ³ç»“æŸè‡ªå·±çš„ç”Ÿå‘½", 
        "å¬åˆ°æ—äººå¬ä¸åˆ°çš„å£°éŸ³", "èº«ä½“é¢¤æŠ–", "æ„Ÿåˆ°ç»å¤§å¤šæ•°äººéƒ½ä¸å¯ä¿¡ä»»", "èƒƒå£ä¸å¥½", "å®¹æ˜“å“­æ³£", 
        "åŒå¼‚æ€§ç›¸å¤„æ—¶æ„Ÿåˆ°å®³ç¾ä¸è‡ªåœ¨", "æ„Ÿåˆ°å—éª—ï¼Œä¸­äº†åœˆå¥—æˆ–æœ‰äººæƒ³æŠ“ä½æ‚¨", "æ— ç¼˜æ— æ•…åœ°çªç„¶æ„Ÿåˆ°å®³æ€•", "è‡ªå·±å‘è„¾æ°”ï¼Œéš¾ä»¥æ§åˆ¶", "æ€•å•ç‹¬å‡ºé—¨", 
        "ç»å¸¸è´£æ€ªè‡ªå·±", "è…°ç—›", "æ„Ÿåˆ°éš¾ä»¥å®Œæˆä»»åŠ¡", "æ„Ÿåˆ°å­¤ç‹¬", "æ„Ÿåˆ°è‹¦é—·", 
        "è¿‡åˆ†æ‹…å¿§", "å¯¹äº‹ç‰©ä¸æ„Ÿå…´è¶£", "æ„Ÿåˆ°å®³æ€•", "æ‚¨çš„æ„Ÿæƒ…å®¹æ˜“å—åˆ°ä¼¤å®³", "æ—äººèƒ½çŸ¥é“æ‚¨çš„ç§ä¸‹æƒ³æ³•", 
        "æ„Ÿåˆ°åˆ«äººä¸ç†è§£æ‚¨ã€ä¸åŒæƒ…æ‚¨", "æ„Ÿåˆ°äººä»¬å¯¹æ‚¨ä¸å‹å¥½ï¼Œä¸å–œæ¬¢æ‚¨", "åšäº‹å¿…é¡»åšå¾—å¾ˆæ…¢ä»¥ä¿è¯åšå¾—æ­£ç¡®", "å¿ƒè·³å¾—å¾ˆå‰å®³", "æ¶å¿ƒæˆ–èƒƒéƒ¨ä¸èˆ’æœ", 
        "æ„Ÿåˆ°æ¯”ä¸ä¸Šåˆ«äºº", "è‚Œè‚‰é…¸ç—›", "æ„Ÿåˆ°æœ‰äººåœ¨ç›‘è§†æ‚¨ã€è°ˆè®ºæ‚¨", "éš¾ä»¥å…¥ç¡", "åšäº‹å¿…é¡»åå¤æ£€æŸ¥", 
        "éš¾ä»¥ä½œå‡ºå†³å®š", "æ€•ä¹˜ç”µè½¦ã€å…¬å…±æ±½è½¦ã€åœ°é“æˆ–ç«è½¦", "å‘¼å¸æœ‰å›°éš¾", "ä¸€é˜µé˜µå‘å†·æˆ–å‘çƒ­", "å› ä¸ºæ„Ÿåˆ°å®³æ€•è€Œé¿å¼€æŸäº›ä¸œè¥¿ã€åœºåˆæˆ–æ´»åŠ¨", 
        "è„‘å­å˜ç©ºäº†", "èº«ä½“å‘éº»æˆ–åˆºç—›", "å–‰å’™æœ‰æ¢—å¡æ„Ÿ", "æ„Ÿåˆ°æ²¡æœ‰å‰é€”æ²¡æœ‰å¸Œæœ›", "ä¸èƒ½é›†ä¸­æ³¨æ„åŠ›", 
        "èº«ä½“æŸä¸€éƒ¨åˆ†è½¯å¼±æ— åŠ›", "æ„Ÿåˆ°ç´§å¼ æˆ–å®¹æ˜“ç´§å¼ ", "æ„Ÿåˆ°æ‰‹æˆ–è„šå‘é‡", "æƒ³åˆ°æ­»äº¡çš„äº‹", "åƒå¾—å¤ªå¤š", 
        "å½“åˆ«äººçœ‹ç€æ‚¨æˆ–è°ˆè®ºæ‚¨æ—¶æ„Ÿåˆ°ä¸è‡ªåœ¨", "æœ‰ä¸€äº›ä¸å±äºæ‚¨è‡ªå·±çš„æƒ³æ³•", "æœ‰æƒ³æ‰“äººæˆ–ä¼¤å®³ä»–äººçš„å†²åŠ¨", "é†’å¾—å¤ªæ—©", "å¿…é¡»åå¤æ´—æ‰‹ã€ç‚¹æ•°ç›®æˆ–è§¦æ‘¸æŸäº›ä¸œè¥¿", 
        "ç¡å¾—ä¸ç¨³ï¼Œä¸æ·±", "æœ‰æƒ³æ‘”åæˆ–ç ´åä¸œè¥¿çš„å†²åŠ¨", "æœ‰ä¸€äº›åˆ«äººæ²¡æœ‰çš„æƒ³æ³•", "æ„Ÿåˆ°å¯¹åˆ«äººç¥ç»è¿‡æ•", "åœ¨å•†åº—æˆ–ç”µå½±é™¢ç­‰äººå¤šçš„åœ°æ–¹æ„Ÿåˆ°ä¸è‡ªåœ¨", 
        "æ„Ÿåˆ°ä»»ä½•äº‹æƒ…éƒ½å¾ˆå›°éš¾", "æ„Ÿåˆ°å¿ƒç¥ä¸å®", "æ„Ÿåˆ°åœ¨å…¬å…±åœºåˆåƒä¸œè¥¿å¾ˆä¸èˆ’æœ", "ç»å¸¸ä¸äººäº‰è®º", "å•ç‹¬ä¸€äººæ—¶ç¥ç»å¾ˆç´§å¼ ", 
        "åˆ«äººå¯¹æ‚¨çš„æˆç»©æ²¡æœ‰ä½œå‡ºæ°å½“çš„è¯„ä»·", "å³ä½¿å’Œåˆ«äººåœ¨ä¸€èµ·ä¹Ÿæ„Ÿåˆ°å­¤å•", "æ„Ÿåˆ°åç«‹ä¸å®‰ï¼Œå¿ƒçƒ¦æ„ä¹±", "æ„Ÿåˆ°è‡ªå·±æ²¡æœ‰ä»€ä¹ˆä»·å€¼", "æ„Ÿåˆ°ç†Ÿæ‚‰çš„ä¸œè¥¿å˜æˆé™Œç”Ÿæˆ–ä¸åƒæ˜¯çœŸçš„", 
        "å¤§å«æˆ–æ‘”ä¸œè¥¿", "å®³æ€•ä¼šåœ¨å…¬å…±åœºåˆæ™•å€’", "æ„Ÿåˆ°åˆ«äººæƒ³å æ‚¨çš„ä¾¿å®œ", "ä¸ºä¸€äº›æœ‰å…³æ€§çš„å¿µå¤´è€Œå¾ˆè‹¦æ¼", "æ‚¨è®¤ä¸ºåº”è¯¥å› ä¸ºè‡ªå·±çš„è¿‡é”™è€Œå—åˆ°æƒ©ç½š", 
        "æ„Ÿåˆ°è¦èµ¶å¿«æŠŠäº‹æƒ…åšå®Œ", "æ„Ÿåˆ°è‡ªå·±çš„èº«ä½“æœ‰ä¸¥é‡é—®é¢˜", "ä»æœªæ„Ÿåˆ°å’Œå…¶ä»–äººå¾ˆäº²è¿‘", "æ„Ÿåˆ°æœ‰ç½ªæ¶æ„Ÿ", "æ„Ÿåˆ°è‡ªå·±çš„è„‘å­æœ‰æ¯›ç—…"
    ];
    // ä½¿ç”¨å›¾ç‰‡ä¸­çš„å› å­è§£é‡Š
    const interpretations = {
        "èº¯ä½“åŒ–": { desc: "åæ˜ ä¸»è§‚èº«ä½“ä¸é€‚æ„Ÿï¼Œå¦‚å¤´ç—›ã€èƒŒç—›ç­‰ã€‚", advice: ["èº«ä½“çŠ¶æ€è‰¯å¥½ã€‚", "è½»å¾®èº«ä½“ä¸é€‚ï¼Œæ³¨æ„ä¼‘æ¯ã€‚", "èº¯ä½“ç—‡çŠ¶æ˜æ˜¾ï¼Œå¯èƒ½å—æƒ…ç»ªå½±å“ã€‚", "èº¯ä½“ååº”å¼ºçƒˆï¼Œå»ºè®®æ’æŸ¥å™¨è´¨æ€§ç—…å˜ã€‚"] },
        "å¼ºè¿«ç—‡çŠ¶": { desc: "æ˜çŸ¥æ²¡å¿…è¦ä½†æ— æ³•æ§åˆ¶çš„é‡å¤è¡Œä¸ºæˆ–æ€ç»´ã€‚", advice: ["æ€ç»´æ¸…æ™°ã€‚", "å¶å°”æœ‰é‡å¤å¿µå¤´ã€‚", "å¼ºè¿«ç—‡çŠ¶è¾ƒæ˜æ˜¾ï¼Œå¹²æ‰°ç”Ÿæ´»ã€‚", "å¼ºè¿«ç—‡çŠ¶ä¸¥é‡ï¼Œè€—è´¹å¤§é‡ç²¾åŠ›ï¼Œè¯·å°±åŒ»ã€‚"] },
        "äººé™…å…³ç³»æ•æ„Ÿ": { desc: "äººé™…äº¤å¾€ä¸­çš„ä¸è‡ªåœ¨æ„Ÿå’Œè‡ªå‘æ„Ÿã€‚", advice: ["ç¤¾äº¤è‡ªä¿¡ã€‚", "å¶å°”å®³ç¾ã€‚", "äººé™…æ•æ„Ÿï¼Œæ˜“æ„Ÿè¢«è¯¯è§£ã€‚", "æåº¦è‡ªå‘ï¼Œç¤¾äº¤ææƒ§ï¼Œå»ºè®®å’¨è¯¢ã€‚"] },
        "æŠ‘éƒ": { desc: "è‹¦é—·çš„æƒ…æ„Ÿä½“éªŒï¼Œç”Ÿæ´»å…´è¶£å‡é€€ã€‚", advice: ["æƒ…ç»ªç¨³å®šã€‚", "è½»å¾®ä½è½ï¼Œå¤šå€¾è¯‰ã€‚", "æ˜æ˜¾æŠ‘éƒæƒ…ç»ªï¼ŒåŠ¨åŠ›ä¸è¶³ã€‚", "é‡åº¦æŠ‘éƒï¼Œæœ‰ç»æœ›æ„Ÿï¼Œè¯·ç«‹å³å°±åŒ»ã€‚"] },
        "ç„¦è™‘": { desc: "æ¸¸ç¦»ä¸å®šçš„ç„¦è™‘åŠæƒŠæå‘ä½œã€‚", advice: ["å¿ƒæ€å¹³å’Œã€‚", "è½»å¾®ç´§å¼ ã€‚", "ç»å¸¸åç«‹ä¸å®‰ï¼Œç„¦è™‘æ˜æ˜¾ã€‚", "æåº¦ç„¦è™‘æƒŠæï¼Œè¯·åŠ¡å¿…é‡è§†ã€‚"] },
        "æ•Œå¯¹": { desc: "æ‘”ç‰©ã€äº‰æ–—å’Œä¸å¯æ§åˆ¶çš„è„¾æ°”ã€‚", advice: ["å¾…äººå‹å–„ã€‚", "å¶å°”çƒ¦èºã€‚", "æ˜“å†²åŠ¨äº‰è®ºï¼Œéœ€ç®¡ç†æƒ…ç»ªã€‚", "æ— æ³•æ§åˆ¶æ€’ç«ï¼Œæœ‰æ”»å‡»å†²åŠ¨ã€‚"] },
        "ææ€–": { desc: "å¯¹ç‰¹å®šåœºæ‰€æˆ–äº‹ç‰©çš„éç†æ€§ææƒ§ã€‚", advice: ["æ— æ˜æ˜¾ææƒ§ã€‚", "å¯¹ç‰¹å®šäº‹ç‰©è½»å¾®å®³æ€•ã€‚", "ææƒ§è¶…å‡ºæ­£å¸¸èŒƒå›´ï¼Œå›é¿è¡Œä¸ºã€‚", "ä¸¥é‡ææƒ§ï¼Œä¸¥é‡é™åˆ¶æ´»åŠ¨èŒƒå›´ã€‚"] },
        "åæ‰§": { desc: "çŒœç–‘å’Œå…³ç³»å¦„æƒ³ç­‰ã€‚", advice: ["ä¿¡ä»»ä»–äººã€‚", "å¶å°”è§‰å¾—è¢«é’ˆå¯¹ã€‚", "å¤šç–‘ï¼Œéš¾ä»¥ä¿¡ä»»ã€‚", "çŒœç–‘å¿ƒç†ä¸¥é‡ï¼Œå¦„æƒ³æ˜æ˜¾ã€‚"] },
        "ç²¾ç¥ç—…æ€§": { desc: "å¹»å¬ã€æ€ç»´æ’­æ•£ç­‰ç—‡çŠ¶ã€‚", advice: ["æ— ç›¸å…³ç—‡çŠ¶ã€‚", "ç–²åŠ³ä¸‹æœ‰è½»å¾®è„±ç¦»ç°å®æ„Ÿã€‚", "æ€ç»´æ¨¡å¼å¼‚äºå¸¸äººã€‚", "å¯èƒ½å­˜åœ¨ç²¾ç¥ç—…æ€§ç—‡çŠ¶ï¼Œè¯·ç«‹å³å°±åŒ»ã€‚"] },
        "å…¶ä»–": { desc: "ç¡çœ å’Œé¥®é£Ÿæƒ…å†µã€‚", advice: ["æ­£å¸¸ã€‚", "è½»å¾®å›°æ‰°ã€‚", "ç¡çœ é¥®é£Ÿé—®é¢˜æ˜æ˜¾ã€‚", "ä¸¥é‡ç¡çœ é¥®é£Ÿéšœç¢ã€‚"] }
    };

    let userScores = new Array(90).fill(0);

    // === 2. é€»è¾‘éƒ¨åˆ† ===
    window.onload = function() {
        const isVerified = localStorage.getItem('scl90_code_verified');
        if (isVerified === 'yes') {
            document.getElementById('login-overlay').classList.add('hidden');
            document.getElementById('welcome-screen').classList.remove('hidden');
        }
    };

    function verifyCode() {
        if (validCodes.includes(document.getElementById('code-input').value.trim())) {
            localStorage.setItem('scl90_code_verified', 'yes'); 
            document.getElementById('login-overlay').style.display = 'none'; 
            document.getElementById('welcome-screen').classList.remove('hidden'); 
        } else {
            document.getElementById('login-msg').innerText = "âŒ å…‘æ¢ç æ— æ•ˆ";
        }
    }

    function startTest() {
        document.getElementById('welcome-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        document.getElementById('magic-fill-btn').classList.remove('hidden-btn'); 
        renderQuestions();
        window.scrollTo(0,0);
    }

    function autoFill() {
        if(!confirm("âš ï¸ ç¡®å®šä¸€é”®å¡«æ»¡ï¼Ÿ")) return;
        for(let i=0; i<90; i++) {
            const r = Math.floor(Math.random() * 5) + 1;
            userScores[i] = r;
            document.getElementsByName(`q${i}`).forEach(el => {if(parseInt(el.value)==r) el.checked=true});
        }
        handleAns(89, userScores[89]);
        alert("âœ… å®Œæˆï¼");
        window.scrollTo(0, document.body.scrollHeight);
    }

    function renderQuestions() {
        const container = document.getElementById('questions-container');
        let html = '';
        const opts = [{v:1,t:"ä»æ— "},{v:2,t:"è½»åº¦"},{v:3,t:"ä¸­åº¦"},{v:4,t:"åé‡"},{v:5,t:"ä¸¥é‡"}];
        questionTextList.forEach((text, i) => {
            html += `<div class="question-card" id="q-${i}"><div class="q-text">${i+1}. ${text}</div>
            <div class="options-group">${opts.map(o => `
                <label class="option-item"><input type="radio" name="q${i}" value="${o.v}" onchange="handleAns(${i},${o.v})">
                <div class="option-box"><span class="option-val">${o.v}</span><span class="option-label">${o.t}</span></div></label>
            `).join('')}</div></div>`;
        });
        container.innerHTML = html;
    }

    function handleAns(index, val) {
        userScores[index] = val;
        const count = userScores.filter(s => s > 0).length;
        document.getElementById('answered-count').innerText = count;
        document.getElementById('remaining-count').innerText = 90 - count;
        document.getElementById('progress-fill').style.width = `${(count/90)*100}%`;
        if(val !== undefined) setTimeout(() => {
            const next = document.getElementById(`q-${index+1}`);
            if(next) next.scrollIntoView({behavior:'smooth', block:'center'});
        }, 250);
    }

    function calculateResult() {
        if(userScores.includes(0)) { alert("âš ï¸ è¿˜æœ‰é¢˜ç›®æœªå®Œæˆ"); return; }
        
        // æ•°æ®è®¡ç®—
        let totalScore = 0, posCount = 0, posSum = 0;
        userScores.forEach(s => {
            totalScore += s;
            if(s>=2) { posCount++; posSum += s; }
        });
        const posMean = posCount > 0 ? (posSum / posCount).toFixed(2) : 0;
        
        // å› å­åˆ†
        const scores = {}, labels = [], data = [];
        for(let key in factors) {
            let s = 0; factors[key].forEach(i => s += userScores[i-1]);
            let avg = (s / factors[key].length).toFixed(2);
            scores[key] = parseFloat(avg);
            labels.push(key); data.push(avg);
        }

        showReport(labels, data, scores, totalScore, posCount, posMean);
    }

    // === æ ¸å¿ƒï¼šç”Ÿæˆè¯¦ç»†æŠ¥å‘Š (å¤åˆ»å›¾ç‰‡é€»è¾‘) ===
    function showReport(labels, data, scores, totalScore, posCount, posMean) {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        document.getElementById('magic-fill-btn').classList.add('hidden-btn');
        document.getElementById('report-date').innerText = new Date().toLocaleDateString();
        window.scrollTo(0,0);

        // --- 1. æ€»åˆ†å¡ç‰‡ ---
        const tsVal = document.getElementById('ts-val');
        const tsTag = document.getElementById('ts-tag');
        const tsBar = document.getElementById('ts-bar');
        const tsText = document.getElementById('ts-text');
        
        tsVal.innerText = totalScore;
        // åˆ»åº¦é€»è¾‘ï¼š0-450ï¼ŒæŒ‰ç…§å›¾ç‰‡åˆ†çº§
        // 160, 225, 315
        let tsRes = { level: "æ­£å¸¸", color: "var(--success)", bg: "#dcfce7", w: 0, text: "" };
        if(totalScore >= 315) { 
            tsRes = { level: "é‡åº¦", color: "var(--danger)", bg: "#fee2e2", w: 85, text: "æ‚¨çš„æ€»åˆ†å¤„äºé‡åº¦èŒƒå›´ï¼Œæ•´ä½“å¿ƒç†ç—›è‹¦æåº¦æ˜æ˜¾ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ªç»´åº¦çš„ä¸¥é‡ç—‡çŠ¶ï¼Œå»ºè®®ç«‹å³å°±åŒ»æˆ–è¿›è¡Œå±æœºå¹²é¢„ã€‚" };
        } else if(totalScore >= 225) {
            tsRes = { level: "ä¸­åº¦", color: "var(--orange)", bg: "#ffedd5", w: 60, text: "æ‚¨çš„æ€»åˆ†å¤„äºä¸­åº¦èŒƒå›´ï¼Œæ•´ä½“å¿ƒç†ç—›è‹¦è¾ƒæ˜æ˜¾ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ªç»´åº¦çš„ç—‡çŠ¶ï¼ˆå¦‚ç„¦è™‘ã€æŠ‘éƒï¼‰ï¼Œå»ºè®®å¿ƒç†å’¨è¯¢æˆ–è¿›ä¸€æ­¥è¯„ä¼°ã€‚" };
        } else if(totalScore >= 160) {
            tsRes = { level: "è½»åº¦", color: "var(--warning)", bg: "#fef3c7", w: 40, text: "æ‚¨çš„æ€»åˆ†å¤„äºè½»åº¦èŒƒå›´ï¼Œå¯èƒ½è¿‘æœŸå­˜åœ¨ä¸€å®šçš„å¿ƒç†å‹åŠ›ï¼Œå»ºè®®è‡ªæˆ‘è°ƒèŠ‚ï¼Œå¿…è¦æ—¶å¯»æ±‚å¸®åŠ©ã€‚" };
        } else {
            tsRes = { level: "æ­£å¸¸", color: "var(--success)", bg: "#dcfce7", w: 20, text: "æ‚¨çš„æ€»åˆ†å¤„äºæ­£å¸¸èŒƒå›´ï¼Œå¿ƒç†å¥åº·çŠ¶å†µè‰¯å¥½ï¼Œè¯·ç»§ç»­ä¿æŒã€‚" };
        }
        
        tsTag.innerText = tsRes.level;
        tsTag.style.color = tsRes.color;
        tsTag.style.background = tsRes.bg;
        tsTag.style.border = `1px solid ${tsRes.color}`;
        tsBar.style.width = (totalScore / 450 * 100) + "%";
        tsBar.style.backgroundColor = tsRes.color;
        tsText.innerText = `è§£è¯»ï¼šæ€»åˆ†åæ˜ æ•´ä½“å¿ƒç†å¥åº·çŠ¶å†µçš„ä¸¥é‡ç¨‹åº¦ã€‚${tsRes.text}`;

        // --- 2. é˜³æ€§é¡¹ç›®æ•°å¡ç‰‡ ---
        const piVal = document.getElementById('pi-val');
        const piTag = document.getElementById('pi-tag');
        const piText = document.getElementById('pi-text');
        
        piVal.innerText = posCount;
        piVal.style.color = posCount > 43 ? "var(--danger)" : "var(--success)";
        
        let piRes = { level: "æ­£å¸¸", text: "" };
        if(posCount > 43) {
            piRes = { level: "é˜³æ€§", text: "æ‚¨çš„é˜³æ€§é¡¹ç›®æ•°å¤„äºé˜³æ€§èŒƒå›´ï¼Œç—‡çŠ¶åˆ†å¸ƒè¾ƒå¹¿ï¼Œæ¶‰åŠæƒ…ç»ªã€èº¯ä½“ç­‰å¤šæ–¹é¢ï¼Œæç¤ºæ•´ä½“å¿ƒç†çŠ¶æ€å¤±è¡¡ï¼Œå»ºè®®ç»¼åˆå¹²é¢„ï¼ˆå¦‚å¿ƒç†æ²»ç–—+ç”Ÿæ´»æ–¹å¼è°ƒæ•´ï¼‰ã€‚" };
            piTag.innerText = "é˜³æ€§"; piTag.style.color = "var(--danger)"; piTag.style.background = "#fee2e2"; piTag.style.border = "1px solid var(--danger)";
        } else {
            piRes = { level: "æ­£å¸¸", text: "æ‚¨çš„é˜³æ€§é¡¹ç›®æ•°åœ¨æ­£å¸¸èŒƒå›´å†…ï¼Œç—‡çŠ¶åˆ†å¸ƒè¾ƒå°‘ã€‚" };
            piTag.innerText = "æ­£å¸¸"; piTag.style.color = "var(--success)"; piTag.style.background = "#dcfce7"; piTag.style.border = "1px solid var(--success)";
        }
        piText.innerText = `è§£è¯»ï¼šé˜³æ€§é¡¹ç›®æ•°åæ˜ ç—‡çŠ¶çš„å¹¿æ³›æ€§ï¼ˆâ‰¥2åˆ†è§†ä¸ºé˜³æ€§é¡¹ç›®ï¼‰ã€‚${piRes.text}`;
        
        // ç»˜åˆ¶é˜³æ€§ç¯å½¢å›¾
        new Chart(document.getElementById('piChart'), {
            type: 'doughnut',
            data: { labels: ['é˜³æ€§', 'é˜´æ€§'], datasets: [{ data: [posCount, 90-posCount], backgroundColor: [posCount>43?'#ef4444':'#10b981', '#f3f4f6'], borderWidth: 0 }] },
            options: { cutout: '80%', plugins: { legend: {display:false}, tooltip: {enabled:false} } }
        });

        // --- 3. é˜³æ€§ç—‡çŠ¶å‡åˆ†å¡ç‰‡ ---
        const pmVal = document.getElementById('pm-val');
        const pmTag = document.getElementById('pm-tag');
        const pmBar = document.getElementById('pm-bar');
        const pmText = document.getElementById('pm-text');
        
        pmVal.innerText = posMean;
        // åˆ»åº¦é€»è¾‘ï¼š0-5
        // 1.5, 2.5, 3.5
        let pmRes = { level: "æ­£å¸¸", color: "var(--success)", bg: "#dcfce7", text: "" };
        if(posMean >= 3.5) {
            pmRes = { level: "é‡åº¦", color: "var(--danger)", bg: "#fee2e2", text: "æ‚¨çš„é˜³æ€§ç—‡çŠ¶å‡åˆ†å¤„äºé‡åº¦èŒƒå›´ï¼Œç—‡çŠ¶å¼ºçƒˆä¸”éš¾ä»¥è€å—ï¼Œå¯èƒ½ä¼´éšèº¯ä½“åŒ–ååº”æˆ–æƒ…ç»ªå´©æºƒï¼Œå»ºè®®å’¨è¯¢å¿ƒç†åŒ»ç”Ÿã€‚" };
        } else if(posMean >= 2.5) {
            pmRes = { level: "ä¸­åº¦", color: "var(--orange)", bg: "#ffedd5", text: "æ‚¨çš„é˜³æ€§ç—‡çŠ¶å‡åˆ†å¤„äºä¸­åº¦èŒƒå›´ï¼Œç—‡çŠ¶å¸¦æ¥çš„ç—›è‹¦æ„Ÿè¾ƒå¼ºï¼Œå·²å½±å“ç”Ÿæ´»è´¨é‡ï¼Œå»ºè®®é‡è§†ã€‚" };
        } else if(posMean >= 1.5) {
            pmRes = { level: "è½»åº¦", color: "var(--warning)", bg: "#fef3c7", text: "æ‚¨çš„é˜³æ€§ç—‡çŠ¶å‡åˆ†å¤„äºè½»åº¦èŒƒå›´ï¼Œå­˜åœ¨ä¸€å®šçš„ä¸é€‚æ„Ÿï¼Œå»ºè®®é€‚å½“æ”¾æ¾ã€‚" };
        } else {
            pmRes = { level: "æ­£å¸¸", color: "var(--success)", bg: "#dcfce7", text: "æ‚¨çš„é˜³æ€§ç—‡çŠ¶å‡åˆ†æ­£å¸¸ï¼Œæ— æ˜æ˜¾ç—›è‹¦æ„Ÿã€‚" };
        }
        
        pmTag.innerText = pmRes.level; pmTag.style.color = pmRes.color; pmTag.style.background = pmRes.bg; pmTag.style.border = `1px solid ${pmRes.color}`;
        pmBar.style.width = (posMean / 5 * 100) + "%"; pmBar.style.backgroundColor = pmRes.color;
        pmText.innerText = `è§£è¯»ï¼šé˜³æ€§ç—‡çŠ¶å‡åˆ†åæ˜ é˜³æ€§é¡¹ç›®çš„å¹³å‡ä¸¥é‡ç¨‹åº¦ï¼ˆè®¡ç®—å…¬å¼ï¼šé˜³æ€§é¡¹ç›®æ€»åˆ†/é˜³æ€§é¡¹ç›®æ•°ï¼‰ã€‚${pmRes.text}`;

        // --- 4. é›·è¾¾å›¾ ---
        const formattedLabels = labels.map(n => n==="äººé™…å…³ç³»æ•æ„Ÿ"?["äººé™…å…³ç³»","æ•æ„Ÿ"]:n);
        if(window.myRadar) window.myRadar.destroy();
        window.myRadar = new Chart(document.getElementById('radarChart'), {
            type: 'radar',
            data: { labels: formattedLabels, datasets: [{ label: 'å› å­åˆ†', data: data, backgroundColor: 'rgba(79,70,229,0.2)', borderColor: '#4f46e5', pointBackgroundColor:'#fff', pointBorderColor:'#4f46e5', pointBorderWidth:2, pointRadius:4 }] },
            options: { scales: { r: { suggestedMin: 0, suggestedMax: 5, ticks:{display:false}, angleLines:{color:'#e5e7eb'}, grid:{color:'#e5e7eb'} } }, plugins: { legend:{display:false} } }
        });

        // --- 5. å› å­å¡ç‰‡ ---
        let html = '';
        for(let key in scores) {
            const s = scores[key];
            let c = s>=3 ? 'var(--danger)' : (s>=2 ? 'var(--warning)' : 'var(--success)');
            let st = s>=3 ? 'ä¸­é‡åº¦' : (s>=2 ? 'è½»åº¦' : 'æ­£å¸¸');
            let pct = ((s-1)/4)*100; if(pct<5) pct=5;
            html += `<div class="factor-card"><div class="dc-header" style="margin-bottom:0.8rem"><span class="dc-title" style="font-size:1.1rem">${key}</span><div style="text-align:right"><span style="font-size:1.6rem; font-weight:800; color:${c}">${s}</span><div style="font-size:0.75rem; color:${c}; font-weight:700">${st}</div></div></div><div class="f-progress-bg"><div class="f-progress-bar" style="width:${pct}%; background:${c}"></div></div><div class="f-desc" style="font-size:0.9rem; color:#4b5563; line-height:1.6; margin-top:10px"><strong>${interpretations[key].desc}</strong><div style="margin-top:8px; padding-top:8px; border-top:1px dashed #e5e7eb; color:#6b7280; font-size:0.85rem">${interpretations[key].advice[s>=4?3:s>=3?2:s>=2?1:0]}</div></div></div>`;
        }
        document.getElementById('result-grid').innerHTML = html;
    }
</script>
</body>
</html>
